# RootEncoder
_(v1.0.0)_

Библиотека для Arduino для работы с ротационными энкодерами: Неограниченный счетчик кликов, удержаний и callback'ов через лямбды.

---

## Возможности

* Определение направления вращения энкодера
* Подсчёт кликов кнопки (одиночные и множественные. Без ограничений)
* Обработка событий удержания кнопки (Hold)
* Callback'и через лямбды
* Опциональный пин кнопки (можно использовать энкодер без кнопки)

---

## Установка

1. Скачайте или клонируйте репозиторий:

```bash
git clone https://github.com/RootTool0/RootEncoder.git
```

2. Скопируйте папку RootEncoder в папку libraries Arduino.

3. Перезапустите Arduino IDE.

--- 

## Использование библиотеки

### Создание объекта

```cpp
RootEncoder(uint8_t InPinA, uint8_t InPinB, uint8_t InPinButton = 255);
```

* `PinA` - Пин подключения сигнала A энкодера
* `PinB` - Пин подключения сигнала B энкодера
* `PinButton` - Пин подключения кнопки (По умолчанию - `255`)

_(P.S. Если `PinButton` == `255`, то кнопка не обрабатывается)_

---

### Инициализация

```cpp
void Setup();
```

* Настраивает пины энкодера и кнопки как входные
* Должно вызываться в `setup()`

---

### Обновление состояния

```cpp
void Update();
```

* Должно вызываться в `loop()`
* Отслеживает вращения энкодера и события кнопки
* Вызывает назначенные callback'и (`OnRotate` и `OnPressEvent`)

---

### Callback'и


#### OnRotate

```cpp
void (*OnRotate)(int8_t);
```

* Вызывается при вращении энкодера
* `Delta` = Направление вращения:
  * `+1` - По часовой стрелке
  * `-1` - Против часовой стрелки

Пример:

```cpp
Encoder.OnRotate = [](int8_t Delta) { /* Код */ };
```

---

#### OnPressEvent

```cpp
void (*OnPressEvent)(uint8_t);
```

* Вызывается при нажатии или удержании кнопки
* `Clicks` = Количество кликов:
  * `0` - Кнопка была удержана (`Hold`)
  * `1...N` - Количество последовательных кликов

Пример:

```cpp
Encoder.OnPressEvent = [](uint8_t Clicks) { /* Код */ };
```

---

## Примеры:

- [TestEncoder.ino](examples%2FTestEncoder%2FTestEncoder.ino) - Пример работы энкодера: подсчёт вращений и обработка кликов/удержаний кнопки через лямбды.

---

## Настройки 
(В файле [RootEncoder.h](RootEncoder.h))

`RootEncoder_HoldTime` - Длительность удержания кнопки в мс (по умолчанию 800)

`RootEncoder_ClickTimeout` - Таймаут между кликами в мс (по умолчанию 300)

---

## Лицензия

MIT License

См. файл [LICENSE](LICENSE)

---

## Обратная связь

Если у вас есть вопросы, предложения или баги, то можете связаться со мной:

- **Telegram (канал/блог)**: [RootTool Blog](https://t.me/RootToolBlog)
- **Telegram (ЛС)**: [@RootTool28](https://t.me/RootTool28)
- **Discord**: `.roottool` (или `RootTool#5776`)
- **YouTube**: [RootTool](https://www.youtube.com/@RTEdits0)

_(прошу не беспокоить меня без причины)_
